<!DOCTYPE html>
<html>
<head>
<title>Advanced Search</title>
<style>
* {margin: 0; padding: 0; box-sizing: border-box;}
body {font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background:#0f172a; color:white; padding:20px; min-height: 100vh;}
.container {max-width: 1200px; margin: 0 auto;}
h1 {margin-bottom: 20px; font-size: 2em;}
.nav-bar {text-align: right; margin-bottom: 20px;}
.nav-bar a {color:#3b82f6; text-decoration:none; font-weight: 500; margin-left: 20px;}
.nav-bar a:hover {text-decoration: underline;}
.card {background:#1e293b; padding:20px; border-radius:10px; margin-bottom:20px; box-shadow: 0 4px 6px rgba(0,0,0,0.2);}
.filters {display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;}
input, select {width: 100%; padding:10px; border-radius:6px; border:none; font-family: inherit; background: #0f172a; color: white;}
input::placeholder, select {color: #64748b;}
button {padding:10px 20px; background:#3b82f6; border:none; color:white; border-radius:6px; font-weight: 500; cursor: pointer; transition: all 0.2s;}
button:hover {background:#2563eb;}
table {width:100%; border-collapse:collapse; margin-top:15px;}
th, td {padding:12px; border-bottom:1px solid #334155; text-align:left;}
th {background:#2563eb; font-weight: 600;}
tr:hover {background:#334155;}
.pending {color: #fca5a5;}
.paid {color: #86efac;}
</style>
</head>
<body>

<div class="container">
<h1>üîç Advanced Search & Filters</h1>
<div class="nav-bar">
  <a href="/">‚Üê Dashboard</a>
  <a href="/export/csv">üì• Export CSV</a>
  <a href="/logout">Logout</a>
</div>

<div class="card">
<h2>Search Filters</h2>
<form method="GET">
  <div class="filters">
    <input name="customer" placeholder="Customer name" value="{{ customer_name }}">
    <input name="product" placeholder="Product" value="{{ product_name }}">
    <select name="payment_status">
      <option value="">-- Payment Status --</option>
      <option value="pending" {% if payment_status == 'pending' %}selected{% endif %}>Pending</option>
      <option value="paid" {% if payment_status == 'paid' %}selected{% endif %}>Paid</option>
    </select>
    <input name="date_from" type="date" placeholder="From Date" value="{{ date_from }}">
    <input name="date_to" type="date" placeholder="To Date" value="{{ date_to }}">
  </div>
  <button type="submit">Search</button>
  <a href="/search-advanced"><button type="button" style="background: #64748b;">Clear</button></a>
</form>
</div>

<div class="card">
<h2>Results ({{ records|length }} found)</h2>
{% if records %}
  <table>
    <thead>
      <tr>
        <th>Customer</th>
        <th>Product</th>
        <th>Qty (kg)</th>
        <th>Total (RWF)</th>
        <th>Paid (RWF)</th>
        <th>Loan (RWF)</th>
        <th>Date</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for r in records %}
        <tr>
          <td><a href="/customer/{{ r.customer_id }}" style="color: #60a5fa;">{{ r.full_name }}</a></td>
          <td>{{ r.product }}</td>
          <td>{{ "%.2f"|format(r.quantity) }}</td>
          <td>{{ r.total|rwf }}</td>
          <td>{{ r.paid|rwf }}</td>
          <td>{{ r.loan|rwf }}</td>
          <td>{{ r.date or '‚Äì' }}</td>
          <td class="{% if r.payment_status == 'pending' %}pending{% else %}paid{% endif %}">{{ r.payment_status|upper }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p style="color: #94a3b8;">No records found matching your search criteria.</p>
{% endif %}
</div>

</div>

</body>
</html>
